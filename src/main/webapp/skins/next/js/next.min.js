/*
 * Solo - A small and beautiful blogging system written in Java.
 * Copyright (c) 2010-2019, b3log.org & hacpai.com
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */
var toggleFlag=!0,NextExpands={toggleOff:function(t,e){return t.removeClass("sidebar-active"),$("body").animate({"padding-right":0}),e.animate({right:-320}),e.find("section").css("opacity",0),!1},toggleOn:function(t,e){return $(t).addClass("sidebar-active"),$("body").animate({"padding-right":320}),e.animate({right:0},function(){e.find("section:first").animate({opacity:1})}),!0},setStorage:function(t,e){window.localStorage.setItem(t,e)},getStorage:function(t){return window.localStorage.getItem(t)}},ExpandsUtil={initToogle:function(){return!0}},NexT={init:function(){$(".sidebar-toggle").click(function(){var t=$(".sidebar");toggleFlag="true"==NextExpands.getStorage("toggleFlag")?NextExpands.toggleOff($(this),t):NextExpands.toggleOn($(this),t),NextExpands.setStorage("toggleFlag",toggleFlag)}),$(".site-nav-toggle").click(function(){$(".site-nav").slideToggle()}),$(document).ready(function(){setTimeout(function(){$(".logo-wrap").css("opacity",1),$(".logo-line-before i").animate({left:"0"},function(){$(".site-title").css("opacity",1).animate({top:0},function(){$(".menu").css("opacity",1).animate({"margin-top":"15px"}),$(".main").css("opacity",1).animate({top:"0"},function(){$(".b3-solo-list li").length>0&&$(window).width()>1e3&&$(".sidebar-toggle").click()})})}),$(".logo-line-after i").animate({right:"0"})},500),console.log(NextExpands.getStorage("toggleFlag")),void 0==NextExpands.getStorage("toggleFlag")&&NextExpands.setStorage("toggleFlag",ExpandsUtil.initToogle()),"true"==NextExpands.getStorage("toggleFlag")&&NextExpands.setStorage("toggleFlag",NextExpands.toggleOn($(".sidebar-toggle"),$(".sidebar"))),console.log(NextExpands.getStorage("toggleFlag")),$("body").on("click",".article-body img",function(){window.open(this.src)})})},initArticle:function(){if($(".b3-solo-list li").length>0&&$(window).width()>1e3){$(".sidebar-toggle").addClass("has-toc");var t='<ul><li class="current" data-tab="toc">'+Label.tocLabel+'</li><li data-tab="site">'+Label.siteViewLabel+"</li></ul><section></section>";$(".sidebar").prepend(t);var e=$(".sidebar section:first").html($(".b3-solo-list")),i=$(".sidebar section:last");e.height($(window).height()-90),$(".sidebar > ul > li").click(function(){"toc"===$(this).data("tab")?i.animate({opacity:"0",top:"-50px"},300,function(){e.show().css("top","-50px"),e.animate({opacity:"1",top:"0"},300)}):e.animate({opacity:"0",top:"-50px"},300,function(){e.hide().css("top","-50px"),i.animate({opacity:"1",top:"0"},300)}),$(".sidebar > ul > li").removeClass("current"),$(this).addClass("current")}),this.initToc()}},initToc:function(){var t=$(".article-body [id^=b3_solo_h]"),e=$(".b3-solo-list");$(window).scroll(function(i){if(0===$(".b3-solo-list li").length)return!1;var o=[];t.each(function(t){o.push({id:this.id,offsetTop:this.offsetTop})});for(var a=$(window).scrollTop(),n=0,l=o.length;n<l;n++)if(a<o[n].offsetTop+200){e.find("li").removeClass("current");var s=n>0?n-1:0;e.find('a[href="#'+o[s].id+'"]').parent().addClass("current");break}a>=o[o.length-1].offsetTop+200&&(e.find("li").removeClass("current"),e.find("li:last").addClass("current"))}),$(window).scroll()}};NexT.init();